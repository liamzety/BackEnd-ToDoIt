(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{36:function(e,t,n){e.exports=n.p+"static/media/loader.e30f1374.gif"},38:function(e,t,n){e.exports=n(67)},66:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(17),u=n.n(c),o=n(19),s=n(4),i=n(1),l=n.n(i),p=n(3),f=n(11),m=n(12),d=n(5),h=n(13),v=n(35),b=n.n(v).a.create({withCredentials:!0}),g=function(e,t){return w(e,"GET",t)},O=function(e,t){return w(e,"POST",t)},E=function(e,t){return w(e,"PUT",t)},y=function(e,t){return w(e,"DELETE",t)};function w(e){return j.apply(this,arguments)}function j(){return(j=Object(p.a)(l.a.mark((function e(t){var n,r,a,c=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:"get",r=c.length>2&&void 0!==c[2]?c[2]:null,e.prev=2,e.next=5,b({url:"".concat("/api/").concat(t),method:n,data:r});case 5:return a=e.sent,e.abrupt("return",a.data);case 9:throw e.prev=9,e.t0=e.catch(2),console.log("Had Issues ".concat(n,"ing to the backend, endpoint: ").concat(t,", with data: ").concat(r)),console.dir(e.t0),e.t0.response&&e.t0.response.status,e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var x={loadUsers:function(){return S.apply(this,arguments)},login:function(e){return k.apply(this,arguments)},signup:function(e){return U.apply(this,arguments)},query:function(e){return N.apply(this,arguments)},logout:function(){return _.apply(this,arguments)}};function N(){return(N=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("user/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g("user");case 3:return t=e.sent,console.log("users from service:",t),e.abrupt("return",t);case 8:throw e.prev=8,e.t0=e.catch(0),console.log("userService: Coulnd't get users"),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function k(){return(k=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("auth/login",t);case 3:return n=e.sent,e.abrupt("return",L(n));case 7:throw e.prev=7,e.t0=e.catch(0),console.log("userService: Wrong username or password"),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function U(){return(U=Object(p.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("signup:",t),n=Object(d.a)({notes:[]},t),e.prev=2,e.next=5,O("auth/signup",n);case 5:return r=e.sent,e.abrupt("return",L(r));case 9:return e.prev=9,e.t0=e.catch(2),console.log("userService: Couldn't sign up",e.t0),e.abrupt("return",Promise.reject(e.t0.response.data));case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function _(){return(_=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("auth/logout");case 2:sessionStorage.clear();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return sessionStorage.setItem("user",JSON.stringify(e)),e}function C(e){return function(t){return x.login(e).then((function(n){return t({type:"LOG_USER",user:n}),e})).catch((function(e){throw e}))}}function T(e){return console.log("signing up:",e),function(t){return x.signup(e).then((function(n){return t({type:"LOG_USER",user:n}),e}))}}function R(){return function(e){return x.logout().then((function(){e({type:"LOGOUT"})}))}}function G(e){var t=e.onLogin,n=Object(r.useState)(null),c=Object(h.a)(n,2),u=c[0],s=c[1];function i(e){s(Object(d.a)(Object(d.a)({},u),{},Object(m.a)({},e.target.name,e.target.value)))}return a.a.createElement("form",{className:"user-login",onSubmit:function(e){e.preventDefault(),t(u)}},a.a.createElement("input",{onChange:i,name:"username",type:"text",placeholder:"username"}),a.a.createElement("input",{onChange:i,name:"password",type:"text",placeholder:"password"}),a.a.createElement("button",null,"Login"),a.a.createElement("p",null,"Dont have an account? ",a.a.createElement(o.b,{to:"/sign"},"Sign in here ")))}var D={update:function(e,t){return V.apply(this,arguments)},remove:function(e,t){return J.apply(this,arguments)},add:function(e){return I.apply(this,arguments)}};function I(){return(I=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={title:"Untitled",body:"Write your ideas here!"},e.next=3,O("note",{note:n,user:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=Object(p.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("note/".concat(t),{user:n});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(p.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E("note/".concat(t._id),{note:t,user:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=n(36),M=n.n(A);function P(){return a.a.createElement("div",{className:"loader"},a.a.createElement("img",{src:M.a,alt:""}))}function q(e){var t=e.notes,n=e.onNoteSelect;return t?a.a.createElement("ul",{className:"notes-list"},t.map((function(e){return a.a.createElement("li",{key:e._id,onClick:function(){n(e)}},e.title)}))):a.a.createElement(P,null)}function W(e){var t=e.onRemoveNote,n=e.notes,r=e.onNoteSelect,c=e.onAddNote;return a.a.createElement("div",{className:"sidebar w100"},a.a.createElement("button",{onClick:c},"add"),a.a.createElement(q,{notes:n,onNoteSelect:r,onRemoveNote:t}))}function X(e){e.user;var t=e.onLogOut,n=e.currNote,r=e.onUpdateNote,c=e.isUnsaved,u=e.onRemoveNote;return a.a.createElement("div",{className:"topbar flex align-center space-between"},a.a.createElement("p",{style:{opacity:c?"1":"0"}},"save"),n&&a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null," ",n.title),a.a.createElement("div",{className:"actions"},a.a.createElement("button",{onClick:r},"save"),a.a.createElement("button",{onClick:u},"remove"),a.a.createElement("button",{onClick:t},"LOGOUT"))))}var B=[{path:"/",component:function(e){var t=e.history,n=Object(f.b)();function c(){return(c=Object(p.a)(l.a.mark((function e(r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n(C(r));case 5:t.push("/notes"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("Err:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){sessionStorage.user&&t.push("/notes")}),[]),a.a.createElement("section",{className:"home"},a.a.createElement(G,{onLogin:function(e){return c.apply(this,arguments)}}))}},{path:"/sign",component:function(e){var t=e.history,n=Object(f.b)(),c=Object(r.useState)(null),u=Object(h.a)(c,2),o=u[0],s=u[1];function i(e){s(Object(d.a)(Object(d.a)({},o),{},Object(m.a)({},e.target.name,e.target.value)))}function v(){return(v=Object(p.a)(l.a.mark((function e(r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n(T(r));case 5:t.push("/notes"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("Err:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}return a.a.createElement("form",{className:"user-add",onSubmit:function(e){e.preventDefault(),function(e){v.apply(this,arguments)}(o)}},a.a.createElement("input",{onChange:i,name:"username",type:"text",placeholder:"username"}),a.a.createElement("input",{onChange:i,name:"password",type:"text",placeholder:"password"}),a.a.createElement("button",null,"Sign up"))}},{path:"/notes",component:function(e){var t=e.history,n=Object(f.b)(),c=Object(f.c)((function(e){return e.userReducer})).loggedUser,u=Object(r.useState)(null),o=Object(h.a)(u,2),s=o[0],i=o[1],v=Object(r.useState)(null),b=Object(h.a)(v,2),g=b[0],O=b[1],E=Object(r.useState)(!1),y=Object(h.a)(E,2),w=y[0],j=y[1];function N(e){e.ctrlKey&&"s"===e.key&&(e.preventDefault(),S())}function S(){var e,t;n((e=g,t=c,function(){var n=Object(p.a)(l.a.mark((function n(r){var a;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,D.update(e,t);case 2:a=n.sent,r({type:"SAVE_NOTE",updatedUser:a});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())),i(g)}function k(){return(k=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(R());case 2:t.push("/");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){i(e),O(e)}return Object(r.useEffect)((function(){var e;c?(n((e=c._id,function(){var t=Object(p.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.query(e);case 2:r=t.sent,n({type:"LOG_USER",user:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),U(c.notes[c.notes.length-1])):t.push("/")}),[]),Object(r.useEffect)((function(){!s||s.body===g.body&&s.title===g.title?j(!1):j(!0)}),[g,s]),Object(r.useEffect)((function(){return window.addEventListener("keydown",N),function(){return window.removeEventListener("keydown",N)}})),Object(r.useEffect)((function(){console.log("updated loggeduser",c.notes),U(c.notes[c.notes.length-1]||null)}),[c.notes.length]),c?a.a.createElement("section",{className:"note-app flex"},a.a.createElement("div",{className:"col-left flex"},a.a.createElement(W,{notes:c.notes,onNoteSelect:function(e){U(e)},onAddNote:function(){var e;n((e=c,function(){var t=Object(p.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.add(e);case 2:r=t.sent,n({type:"SAVE_NOTE",updatedUser:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))}})),a.a.createElement("div",{className:"col-right col flex "},a.a.createElement(X,{isUnsaved:w,currNote:g,user:c,onUpdateNote:S,onRemoveNote:function(){var e,t;n((e=g._id,t=c,function(){var n=Object(p.a)(l.a.mark((function n(r){var a;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,D.remove(e,t);case 2:a=n.sent,r({type:"REMOVE_NOTE",updatedUser:a});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()))},onLogOut:function(){return k.apply(this,arguments)}}),g&&0!==c.notes.length?a.a.createElement("textarea",{name:"body",value:g.body,onChange:function(e){var t=e.target;O((function(e){return Object(d.a)(Object(d.a)({},e),{},Object(m.a)({},t.name,t.value))}))},className:"editor h100"}):a.a.createElement("h1",null,"No notes left!"))):a.a.createElement("h1",null,"Loading...")}}];var F=function(){return a.a.createElement("main",{className:"app"},a.a.createElement(o.a,null,a.a.createElement(s.c,null,B.map((function(e){return a.a.createElement(s.a,{key:e.path,exact:!0,component:e.component,path:e.path})})))))},H=n(14),K=n(37),z=null;sessionStorage.user&&(z=JSON.parse(sessionStorage.user));var Q={loggedUser:z};var Y=Object(H.c)({userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOG_USER":return sessionStorage.setItem("user",JSON.stringify(t.user)),Object(d.a)(Object(d.a)({},e),{},{loggedUser:t.user});case"LOGOUT":return Object(d.a)(Object(d.a)({},e),{},{loggedUser:null});case"SAVE_NOTE":case"REMOVE_NOTE":return sessionStorage.setItem("user",JSON.stringify(t.updatedUser)),Object(d.a)(Object(d.a)({},e),{},{loggedUser:t.updatedUser});default:return e}}}),Z=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||H.d,$=Object(H.e)(Y,Z(Object(H.a)(K.a)));n(66);u.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(f.a,{store:$},a.a.createElement(F,null))),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.b747b9a3.chunk.js.map